function initializeCRUDForm(){initializeValidationCRUDForm();$(".crud-form .action-buttons .cancel.button").click(function(){hideFormModal()});$(".crud-form .add.button").each(function(){$(this).click(function(){onClickActionButton(this)})});$(".crud-form .add-property.button").click(function(){addPropertyForm($(".crud-form .properties"));updateProperties();initializeValidationCRUDForm()});$(".crud-form .ui.dropdown").dropdown({onChange:function(){updateProperties()}})}function crudFormSubmit(n){var n=$(n),u=$(arguments[1]),i=n.closest("form").attr("action"),r=n.closest("form").serialize(),t=1e3;activeMessageLoader();$.ajax({url:i,type:"post",data:r,success:function(n){if(typeof n!==undefined){if(inactiveMessageLoader(),showMessage(n),n.type!=="error")if(activeMessageProgress(),typeof n.results.Reload!==undefined&&n.results.Reload===!0)setTimeout(function(){location.reload();message.modal("hide")},t);else{var i=n.results.RedirectUrl;typeof i!==undefined&&setTimeout(function(){location=i;message.modal("hide")},t)}}else inactiveMessageLoader(),showDefaultErrorMessage()},error:function(){inactiveMessageLoader();showDefaultErrorMessage()}})}function initializePropertyFieldset(){$(".property .remove.button").click(function(){var n=$(this).closest(".property");n.transition({animation:"scale",onComplete:function(){$(this).closest(".property").remove();updateProperties();initializeValidationCRUDForm()}})})}function addPropertyForm(n){var n=$(n),t=$("#properties");n.append(t.html());t=n.children(".fields:last-child");initializePropertyFieldset()}function updateProperties(){var n=$(".crud-form .properties .fields");n.each(function(n){$(this).find("input").each(function(){var i=$(this).attr("default-name"),t;typeof i!==undefined&&(t="properties["+n+"]."+i,$(this).attr("id",t),$(this).attr("name",t))});$(this).find(".ui.search").each(function(){console.log($("#"+$(this).attr("for-id")).val());$(this).search({minCharacters:0,apiSettings:{url:$(this).attr("href")+"?"+$(this).attr("for-id")+"="+$("#"+$(this).attr("for-id")).val()},fields:{results:"results",title:"title"},error:!1})})})}function initializeDataTable(){var n=$(".data-table");$(".data-table .action-buttons .item").click(function(n){onClickActionButton(this,n)})}function initializeIndexPagination(){var n=$("#index-pagination > .ui.dropdown");n.dropdown("set selected",$("#page-index").val());n.dropdown({onChange:function(n){location.search({page:n})}})}function onClickActionButton(n){n=$(n);var i=n.attr("href"),t=$("#form-modal");activeMessageLoader();$.ajax({url:i,type:"post",success:function(n){typeof n=="string"?(t.html(n),initializeCRUDForm(),inactiveMessageLoader(),t.modal("show")):(inactiveMessageLoader(),showMessage(n))},error:function(){return inactiveMessageLoader(),showDefaultErrorMessage(),null}})}function showDefaultErrorMessage(){var n=$("#message"),t=$("#message>.header>.title"),i=$("#message>.content");n.attr("type","error");t.text(t.attr("data-default-value"));i.text(i.attr("data-default-value"));n.children(".header").find(">.icon").addClass("hidden");n.children(".actions").find(">.button").addClass("hidden");n.children(".header").find(">.error").removeClass("hidden");n.children(".actions").find(">.error").removeClass("hidden");n.modal("show")}function showMessage(n){if(typeof n!==undefined){var t=$("#message"),i=$("#message>.header>.title"),r=$("#message>.content");t.attr("type",n.type);i.text(n.header);r.text(n.content);t.children(".header").find(">.icon").addClass("hidden");t.children(".actions").find(">.button").addClass("hidden");t.children(".header").find(">."+n.type).removeClass("hidden");t.children(".actions").find(">."+n.type).removeClass("hidden");t.modal("show")}}function hideMessage(){$("#message").modal("hide")}function activeMessageLoader(){$("#message-loader").addClass("active")}function inactiveMessageLoader(){$("#message-loader").removeClass("active")}function initializeMessageProgress(n,t){$("#message-progress").progress({duration:n,total:t})}function activeMessageProgress(n){var t=$("#message-progress"),i=t.progress("get total"),r=n/i;t.progress("reset");t.removeClass("hidden");setInterval(function(){t.progress("increment")},r)}function inactiveMessageProgress(){var n=$("#message-progress");n.progress("reset");n.addClass("hidden")}function showFormModal(){$("#form-modal").modal("show")}function hideFormModal(){$("#form-modal").modal("hide")}$(document).ready(function(){initializeCRUDForm();$("#form-modal").modal({autofocus:!1});initializeDataTable();initializeIndexPagination();initializeMessageProgress(0,100)});